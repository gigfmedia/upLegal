
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LegalUp - Conecta con abogados experimentados</title>
    <meta name="description" content="Connect with experienced lawyers and get professional legal services. Find the right legal expert for your needs." />
    <meta name="author" content="LegalConnect" />
    

    <meta property="og:title" content="LegalUp - Conecta con abogados experimentados" />
    <meta property="og:description" content="Conecta con abogados experimentados, recibe asesorÃ­a legal y resuelve tus asuntos legales con confianza. Servicios legales profesionales al alcance de tus manos." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lovable_dev" />
    <meta name="twitter:image" content="" />
    
    <!-- MercadoPago SDK with enhanced debugging -->
    <script>
      // Store initial script state
      window.__mp_debug = window.__mp_debug || {};
      window.__mp_debug.initialScripts = Array.from(document.scripts).map(s => ({
        src: s.src,
        id: s.id,
        async: s.async,
        defer: s.defer,
        type: s.type
      }));

      // Track SDK loading state
      window.MercadoPagoSDK = {
        loaded: false,
        onLoadCallbacks: [],
        version: 'unknown',
        loadTime: null,
        sdkUrl: 'https://sdk.mercadopago.com/js/v2'
      };

      // Function to execute callbacks when SDK is loaded
      function onMercadoPagoLoaded() {
        const loadTime = new Date();
        window.MercadoPagoSDK.loaded = true;
        window.MercadoPagoSDK.loadTime = loadTime.toISOString();
        
        // Try to extract version from the script URL
        const sdkScript = document.getElementById('mercado-pago-sdk');
        if (sdkScript) {
          const versionMatch = sdkScript.src.match(/v(\d+\.\d+\.\d+)/);
          if (versionMatch) {
            window.MercadoPagoSDK.version = versionMatch[1];
          }
        }
        
        // Log SDK info
        console.group('MercadoPago SDK Loaded');
        console.log('Load Time:', loadTime.toISOString());
        console.log('SDK URL:', sdkScript?.src || 'unknown');
        console.log('MercadoPago Object:', window.MercadoPago ? 'Available' : 'Not Available');
        console.log('MercadoPago Version:', window.MercadoPagoSDK.version);
        console.groupEnd();

        // Execute callbacks
        window.MercadoPagoSDK.onLoadCallbacks.forEach(callback => callback());
        window.MercadoPagoSDK.onLoadCallbacks = [];
      }

      // Load SDK with callback
      (function(d, s, id) {
        // Check if already loaded
        if (window.MercadoPago) {
          console.log('MercadoPago already loaded, skipping new load');
          onMercadoPagoLoaded();
          return;
        }
        
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        
        js = d.createElement(s);
        js.id = id;
        js.src = window.MercadoPagoSDK.sdkUrl;
        js.async = true;
        js.defer = true;
        js.onload = onMercadoPagoLoaded;
        js.onerror = function(error) {
          console.error('Failed to load MercadoPago SDK:', error);
        };
        
        // Insert before the first script or at the end of head
        if (fjs) {
          fjs.parentNode.insertBefore(js, fjs);
        } else {
          d.head.appendChild(js);
        }
      }(document, 'script', 'mercado-pago-sdk'));
    </script>
    
    <script type="module">
      import { initializeMercadoPago } from './src/lib/mercadoPagoInit';
      
      function initMercadoPago() {
        const mp = initializeMercadoPago();
        if (mp) {
          window.mp = mp; // Make it globally available
          console.log('MercadoPago initialized successfully');
        } else {
          console.error('Failed to initialize MercadoPago');
        }
      }

      // Wait for both DOM and SDK to be ready
      function onReady() {
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', initMercadoPago);
        } else {
          initMercadoPago();
        }
      }

      // Check if SDK is already loaded
      if (window.MercadoPago) {
        console.log('MercadoPago SDK already loaded');
        onReady();
      } else {
        // Wait for SDK to load
        window.MercadoPagoSDK.onLoadCallbacks.push(onReady);
      }
    </script>
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
