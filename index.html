
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LegalUp - Conecta con abogados experimentados</title>
    <meta name="description" content="Connect with experienced lawyers and get professional legal services. Find the right legal expert for your needs." />
    <meta name="author" content="LegalConnect" />
    

    <meta property="og:title" content="LegalUp - Conecta con abogados experimentados" />
    <meta property="og:description" content="Conecta con abogados experimentados, recibe asesorÃ­a legal y resuelve tus asuntos legales con confianza. Servicios legales profesionales al alcance de tus manos." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lovable_dev" />
    <meta name="twitter:image" content="" />
    
    <!-- MercadoPago SDK with enhanced debugging -->
    <script>
      // Store initial script state
      window.__mp_debug = window.__mp_debug || {};
      window.__mp_debug.initialScripts = Array.from(document.scripts).map(s => ({
        src: s.src,
        id: s.id,
        async: s.async,
        defer: s.defer,
        type: s.type
      }));

      // Track SDK loading state
      window.MercadoPagoSDK = {
        loaded: false,
        onLoadCallbacks: [],
        version: 'unknown',
        loadTime: null,
        sdkUrl: 'https://sdk.mercadopago.com/js/v2'
      };

      // Function to execute callbacks when SDK is loaded
      function onMercadoPagoLoaded() {
        const loadTime = new Date();
        window.MercadoPagoSDK.loaded = true;
        window.MercadoPagoSDK.loadTime = loadTime.toISOString();
        
        // Try to get version from different sources
        const sdkScript = document.getElementById('mercado-pago-sdk');
        
        // 1. Check if window.MercadoPago has version info
        if (window.MercadoPago) {
          // Try different possible version properties
          const possibleVersionProps = ['VERSION', 'version', 'sdkVersion', 'SDK_VERSION'];
          for (const prop of possibleVersionProps) {
            if (window.MercadoPago[prop]) {
              window.MercadoPagoSDK.version = window.MercadoPago[prop];
              break;
            }
          }
        }
        
        // 2. If still not found, try to extract from script URL
        if (window.MercadoPagoSDK.version === 'unknown' && sdkScript && sdkScript.src) {
          // Try different URL patterns
          const versionPatterns = [
            /[?&]v=(\d+\.\d+\.\d+)/,  // ?v=1.2.3
            /v(\d+_\d+_\d+)/,           // v1_2_3
            /v(\d+\.\d+\.\d+)/,       // v1.2.3
            /(\d+\.\d+\.\d+)/         // 1.2.3
          ];
          
          for (const pattern of versionPatterns) {
            const match = sdkScript.src.match(pattern);
            if (match) {
              window.MercadoPagoSDK.version = match[1].replace(/_/g, '.');
              break;
            }
          }
        }

        // Execute callbacks
        window.MercadoPagoSDK.onLoadCallbacks.forEach(callback => callback());
        window.MercadoPagoSDK.onLoadCallbacks = [];
      }

      // Load SDK with callback
      (function(d, s, id) {
        // Check if already loaded
        if (window.MercadoPago) {
          console.log('MercadoPago already loaded, skipping new load');
          onMercadoPagoLoaded();
          return;
        }
        
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        
        js = d.createElement(s);
        js.id = id;
        js.src = window.MercadoPagoSDK.sdkUrl;
        js.async = true;
        js.defer = true;
        js.onload = onMercadoPagoLoaded;
        js.onerror = function(error) {
          console.error('Failed to load MercadoPago SDK:', error);
        };
        
        // Insert before the first script or at the end of head
        if (fjs) {
          fjs.parentNode.insertBefore(js, fjs);
        } else {
          d.head.appendChild(js);
        }
      }(document, 'script', 'mercado-pago-sdk'));
    </script>
    
    <script type="module">
      import { initializeMercadoPago } from './src/lib/mercadoPagoInit';
      
      function initMercadoPago() {
        const mp = initializeMercadoPago();
        if (mp) {
          window.mp = mp; // Make it globally available
        }
      }

      // Wait for both DOM and SDK to be ready
      function onReady() {
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', initMercadoPago);
        } else {
          initMercadoPago();
        }
      }

      // Check if SDK is already loaded
      if (window.MercadoPago) {
        onReady();
      } else {
        // Wait for SDK to load
        window.MercadoPagoSDK.onLoadCallbacks.push(onReady);
      }
    </script>
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
